// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  user_id      Int       @id @default(autoincrement())
  name         String
  email        String    @unique
  password_hash String
  created_at   DateTime  @default(now())

  accounts     Account[]
  categories   Category[]
  transactions Transaction[]
  budgets      Budget[]
  export_logs  ExportLog[]
}

model Account {
  account_id   Int       @id @default(autoincrement())
  user_id      Int
  account_name String
  account_type String?
  balance      Decimal   @default(0.00)
  created_at   DateTime  @default(now())

  user         User      @relation(fields: [user_id], references: [user_id])
  transactions Transaction[]
}

model Category {
  category_id Int       @id @default(autoincrement())
  user_id     Int
  name        String
  type        CategoryType // Stores "expense" or "income"

  user         User        @relation(fields: [user_id], references: [user_id])
  transactions Transaction[]
  budgets      Budget[]
}

model Transaction {
  transaction_id  Int       @id @default(autoincrement())
  user_id         Int
  account_id      Int
  category_id     Int
  description     String?
  amount          Decimal
  type            TransactionType // Stores "expense" or "income"
  transaction_date DateTime
  created_at      DateTime @default(now())

  user     User     @relation(fields: [user_id], references: [user_id])
  account  Account  @relation(fields: [account_id], references: [account_id])
  category Category @relation(fields: [category_id], references: [category_id])
}

model Budget {
  budget_id    Int       @id @default(autoincrement())
  user_id      Int
  category_id  Int
  limit_amount Decimal
  start_date   DateTime
  end_date     DateTime
  created_at   DateTime @default(now())

  user     User     @relation(fields: [user_id], references: [user_id])
  category Category @relation(fields: [category_id], references: [category_id])
}

model ExportLog {
  export_id  Int      @id @default(autoincrement())
  user_id    Int
  file_type  String   // CSV, PDF
  created_at DateTime @default(now())

  user User @relation(fields: [user_id], references: [user_id])
}
enum CategoryType {
  expense
  income
}

enum TransactionType {
  expense
  income
}